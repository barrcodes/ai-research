# Top Downloaded Skill in ClawHub Contains Malware

| | |
|---|---|
| **Source** | 1Password Blog |
| **URL** | [1password.com/blog/from-magic-to-malware-how-openclaws-agent-skills-become-an-attack-surface](https://1password.com/blog/from-magic-to-malware-how-openclaws-agent-skills-become-an-attack-surface) |
| **Researched** | 2026-02-05 |

## Overview

AI agent skill registries have emerged as a critical supply chain vulnerability. A sophisticated trojan campaign distributed malware through hundreds of OpenClaw skills, exploiting the collapse between reading documentation and executing code. The attack targets developer credentials, cloud tokens, and browser sessions with techniques that bypass both user intuition and Model Context Protocol controls.

## Key Points

- **Distributed attack**: Hundreds of OpenClaw skills involved in coordinated malware campaigns, targeting top-downloaded repositories to establish credibility
- **Staged payload delivery**: Skills present "required dependencies" with innocent-looking links that decode obfuscated commands, disable macOS security (Gatekeeper), and download final binaries
- **MCP bypass**: Malicious skills execute shell commands directly, circumventing Model Context Protocol restrictions through embedded scripts and bundled code
- **Supply chain amplification**: When agents execute local commands, documentation becomes executable, collapsing threat models—users and AI systems conflate reading with running

## Technical Details

**Attack chain observed**:
1. Trojanized "Twitter" skill in public registry
2. Documentation normalizes risky dependency installation
3. One-liners execute obfuscated payloads (second-stage decoder)
4. Secondary scripts disable macOS security controls
5. Final payload: infostealing malware targeting SSH keys, `.aws` credentials, browser session tokens

**Detection challenges**:
- Markdown skill format obscures executable content
- Social engineering through trusted "top downloaded" status
- Encoded payloads evade simple string matching
- Scripts remove telemetry/audit logs during execution

## Implications

**For architecture decisions**:
- Skills registries require cryptographic verification (publisher signing + registry attestation)
- Default-deny execution model essential: skills should declare required permissions upfront, not embed shell invocations
- Credential stores must be inaccessible to untrusted code—use time-bound, revocable tokens with audit logging

**For practitioners**:
- Never run agent frameworks on machines with corporate credentials/cloud access unless the skill source is internally vetted
- Treat external links in skill documentation as code execution points, not documentation
- Implement registry scanning for encoded payloads, suspicious shell patterns, and removal attempt obfuscation
- Use isolated VMs for third-party skill experimentation

**Alternative threat model**: If your agent framework moves to explicit permission models (like mobile app sandboxing), the risk surface shrinks dramatically—skills can only access declared capabilities with runtime consent.

## Sources

- [1Password Security Research: From Magic to Malware](https://1password.com/blog/from-magic-to-malware-how-openclaws-agent-skills-become-an-attack-surface) - Original disclosure of distributed malware campaign in OpenClaw skill registry
